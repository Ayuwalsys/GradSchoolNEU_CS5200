"0",""
"0","prepareFlightsData <- function(df, airports_df) {"
"0","  # Convert flightDate to Date format"
"0","  df$flight_date <- as.Date(df$flight_date, format = ""%m/%d/%Y"")"
"0",""
"0","  # Map originAirport to airport IDs"
"0","  df$originAirport <- match(df$airport, airports_df$airportName)"
"0",""
"0","  # Handle missing airline values"
"0","  df$airline[is.na(df$airline)] <- ""Unknown"""
"0",""
"0","  # Convert heavy_flag to boolean"
"0","  df$isHeavy <- df$heavy_flag == ""Yes"""
"0",""
"0","  # Subset and rename columns as per table structure"
"0","  flights_df <- data.frame("
"0","    fid = df$rid,"
"0","    date = df$flight_date,"
"0","    originAirport = df$originAirport,"
"0","    airlineName = df$airline,"
"0","    aircraftType = df$aircraft,"
"0","    isHeavy = df$isHeavy"
"0","  )"
"0",""
"0","  return(flights_df)"
"0","}"
"0",""
"0","# Usage"
"0","flights_data <- prepareFlightsData(bds.raw, airports_data)"
"0",""
"0",""
