"0","insertAirportsData <- function(connection, df_airports) {"
"0","  # Check for duplicate entries in airports data"
"0","  if(nrow(airports_data) != nrow(unique(airports_data))) {"
"0","  stop(""Duplicate entries found in airports data"")"
"0","}"
"0","  # resolve single quotes by replacing with two single quotes"
"0","  df_airports$airportName <- gsub(""'"", ""''"", df_airports$airportName)"
"0","  df_airports$airportState <- gsub(""'"", ""''"", df_airports$airportState)"
"0","  df_airports$airportCode <- gsub(""'"", ""''"", df_airports$airportCode)"
"0",""
"0","  dbBegin(connection)"
"0","  tryCatch({"
"0","    dbExecute(connection, sprintf(""INSERT INTO airports (airportName, airportState, airportCode) VALUES %s"","
"0","                                  paste(sprintf(""('%s', '%s', '%s')"", df_airports$airportName, df_airports$airportState, df_airports$airportCode), collapse = "","")))"
"0","    dbCommit(connection)"
"0","  }, error = function(e) {"
"0","    dbRollback(connection)"
"0","    stop(e)"
"0","  })"
"0","}"
"0",""
"0","# Used case"
"0","insertAirportsData(connection, airports_data)"
"1","[1]"
"1"," TRUE"
"1","
"
